{"version":3,"sources":["../../src/openxml/part.js"],"names":[],"mappings":";;;;;;;;;;IAAqB,IAAI;AACb,UADS,IAAI,CACZ,IAAI,EAAC,GAAG,EAAC;wBADD,IAAI;;AAEvB,MAAI,CAAC,IAAI,GAAC,IAAI,CAAA;AACd,MAAI,CAAC,GAAG,GAAC,GAAG,CAAA;AACZ,MAAI,CAAC,eAAe,GAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,eAAe,CAAA;AAC5F,MAAI,CAAC,IAAI,GAAC,EAAE,CAAA;;AAEZ,MAAI,MAAM,GAAC,EAAE;MACZ,OAAO,GAAC,QAAQ,GAAC,IAAI,GAAC,OAAO;MAC7B,CAAC,GAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;AACzB,MAAG,CAAC,KAAG,CAAC,CAAC,EAAC;AACT,SAAM,GAAC,IAAI,CAAC,SAAS,CAAC,CAAC,EAAC,CAAC,CAAC,CAAA;AAC1B,UAAO,GAAC,MAAM,GAAC,SAAS,GAAC,IAAI,CAAC,SAAS,CAAC,CAAC,GAAC,CAAC,CAAC,GAAC,OAAO,CAAC;GACrD;;AAED,MAAG,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,OAAO;;AAE/B,GAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,CAAC,CACrC,eAAe,CAAC,UAAU,CAC1B,OAAO,EAAE,CACT,OAAO,CAAC,UAAS,CAAC,EAAE,CAAC,EAAC;AACtB,OAAI,CAAC,IAAI,CAAC,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,GAAC;AAC/B,QAAI,EAAC,CAAC,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE;AAC5C,cAAU,EAAE,CAAC,CAAC,YAAY,CAAC,YAAY,CAAC;AACxC,UAAM,EAAC,CAAC,CAAC,CAAC,YAAY,CAAC,YAAY,CAAC,IAAE,UAAU,GAAI,MAAM,GAAI,MAAM,GAAC,GAAG,GAAI,EAAE,GAAI,EAAE,CAAA,GAAE,CAAC,CAAC,YAAY,CAAC,QAAQ,CAAC,EAAC,CAAA;GAChH,EAAC,IAAI,CAAC,CAAA;EACR;;cA1BmB,IAAI;;SA2BlB,gBAAC,EAAE,EAAC;AACT,OAAI,GAAG,GAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;AACrB,WAAO,GAAG,CAAC,IAAI;AACf,SAAK,OAAO;AACX,SAAG,GAAG,CAAC,UAAU,IAAE,UAAU,EAC5B,OAAO,GAAG,CAAC,MAAM,CAAA;AAClB,YAAO,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,MAAM,CAAC,CAAA;AAAA,AACzC;AACC,YAAO,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAA;AAAA,IACnC;GACD;;;SAEQ,YAAC,CAAC,EAAC;AACX,UAAO,CAAC,IAAI,CAAC,CAAC,MAAM,CAAA;GACpB;;;QAzCmB,IAAI;;;qBAAJ,IAAI","file":"part.js","sourcesContent":["export default class part{\n\tconstructor(name,doc){\n\t\tthis.name=name\n\t\tthis.doc=doc\n\t\tthis.documentElement=doc.parts[name] && $.parseXML(doc.parts[name].asText()).documentElement\n\t\tthis.rels={}\n\n\t\tvar folder=\"\",\n\t\t\trelName=\"_rels/\"+name+\".rels\",\n\t\t\ti=name.lastIndexOf('/');\n\t\tif(i!==-1){\n\t\t\tfolder=name.substring(0,i)\n\t\t\trelName=folder+\"/_rels/\"+name.substring(i+1)+\".rels\";\n\t\t}\n\n\t\tif(!doc.parts[relName]) return;\n\t\t//console.log(\"part:\"+name+\",relName:\"+relName+\",folder:\"+folder+\", text:\"+doc.parts[relName].asText())\n\t\t$.parseXML(doc.parts[relName].asText())\n\t\t\t.documentElement.childNodes\n\t\t\t.asArray()\n\t\t\t.forEach(function(a, i){\n\t\t\t\tthis.rels[a.getAttribute('Id')]={\n\t\t\t\t\ttype:a.getAttribute('Type').split('/').pop(),\n\t\t\t\t\ttargetMode: a.getAttribute('TargetMode'),\n\t\t\t\t\ttarget:(a.getAttribute('TargetMode')!=\"External\" ? (folder ? (folder+\"/\") : '') : '')+a.getAttribute('Target')}\n\t\t\t},this)\n\t}\n\tgetRel(id){\n\t\tvar rel=this.rels[id]\n\t\tswitch(rel.type){\n\t\tcase 'image':\n\t\t\tif(rel.targetMode=='External')\n\t\t\t\treturn rel.target\n\t\t\treturn this.doc.getImagePart(rel.target)\n\t\tdefault:\n\t\t\treturn this.doc.getPart(rel.target)\n\t\t}\n\t}\n\n\tstatic is(o){\n\t\treturn o && o.getRel\n\t}\n}\n"]}