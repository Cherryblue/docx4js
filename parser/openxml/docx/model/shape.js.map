{"version":3,"sources":["../../../../src/openxml/docx/model/shape.js"],"names":[],"mappings":"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","file":"shape.js","sourcesContent":["import Style from './style'\nimport Drawing from './drawing'\n\nexport default class Shape extends require('../model'){\n\tgetDirectStyle(){\n\t\treturn new this.constructor.Properties(this.wXml,this.wDoc,this)\n\t}\n\t_getValidChildren(){\n\t\treturn this.wXml.$('txbxContent')\n\t}\n\n\tstatic get type(){return 'shape'}\n\n\tstatic get Properties(){return Properties}\n}\n\nfunction phClr(o, clr, a){\n\tfor(var i in o){\n\t\tswitch(typeof(a=o[i])){\n\t\tcase 'string':\n\t\t\tif(a=='phClr')\n\t\t\t\to[i]=clr\n\t\t\tbreak\n\t\tcase 'object':\n\t\t\tphClr(a, clr)\n\t\t}\n\t}\n\treturn o\n}\n\nvar naming=Object.assign({},Style.Properties.naming, Drawing.SpProperties.naming)\nclass Properties extends Style.Properties{\n\tstatic get naming(){return naming}\n}\n\n\nObject.assign(Properties.prototype,Drawing.SpProperties.prototype,{\n\t_getValidChildren(t){\n\t\tvar children=((t=this.wXml.$('>style>*')) && t.asArray() ||[])\n\t\t\t.concat(this.wXml.$('>spPr>*, >bodyPr>*').asArray());\n\t\tvar bodyPr=this.wXml.$1('bodyPr')\n\t\tif(bodyPr){\n\t\t\tfor(var i=0, attrs=bodyPr.attributes, len=attrs.length;i<len;i++)\n\t\t\t\tchildren.push(attrs[i])\n\t\t}\n\t\treturn children\n\t},\n\tlnRef(x){\n\t\treturn phClr(this.wDoc.getFormatTheme().line(x.attr('idx')),this.solidFill(x))\n\t},\n\tfillRef(x){\n\t\treturn phClr(this.wDoc.getFormatTheme().fill(x.attr('idx')),this.solidFill(x))\n\t},\n\tfontRef(x){\n\t\treturn {color:this.solidFill(x), family: this.wDoc.getFormatTheme().font(x.attr('idx'))}\n\t},\n\teffectRef(){\n\n\t},\n\tspAutoFit(){\n\t\treturn true\n\t},\n\tlIns(x){\n\t\tif(x=parseInt(x.value))\n\t\t\treturn this.asPt(x,'cm')\n\t\treturn this.EMPTY\n\t},\n\ttIns(x){\n\t\treturn this.lIns(x)\n\t},\n\trIns(x){\n\t\treturn this.lIns(x)\n\t},\n\tbIns(x){\n\t\treturn this.lIns(x)\n\t},\n\tanchor(x){\n\t\tswitch(x.value){\n\t\tcase 'b':\n\t\t\treturn 'bottom'\n\t\tcase 't':\n\t\t\treturn 'top'\n\t\tdefault:\n\t\t\treturn 'middle'\n\t\t}\n\t},\n\tvert(x){\n\t\tswitch(x.value){\n\t\tcase 'horz':\n\t\t\treturn this.EMPTY\n\t\tcase 'eaVert':\n\t\t\treturn 90\n\t\tcase 'vert270':\n\t\t\treturn 270\n\t\tdefault:\n\t\t\tconsole.warn('not support')\n\t\t\treturn this.EMPTY\n\t\t}\n\t}\n})\n"]}