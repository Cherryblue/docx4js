{"version":3,"sources":["../../../../../src/openxml/docx/model/field/field.js"],"names":[],"mappings":"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","file":"field.js","sourcesContent":["export default class Field extends require('../../model'){\n\tconstructor(instruct,doc, parent){\n\t\tsuper(...arguments)\n\t\tthis.command=new this.constructor.FieldCode(instruct)\n\t\tthis.command.parse()\n\t}\n\n\tparse(visitors, endVisitors){\n\t\tfor(var i=0, len=visitors.length;i<len;i++)\n\t\t\tvisitors[i].visit(this, endVisitors[i])\n\t}\n\tgetCommand(){\n\t\treturn this.command\n\t}\n\n\tstatic get type(){return 'field'}\n\n\tstatic get Command(){return Command}\n\n\tstatic get Switch(){return Switch}\n\n\tstatic get FieldCode(){return FieldCode}\n}\n\nclass Command{\n\tconstructor(instruct){\n\t\tthis.data=instruct\n\t}\n\n\tnextUntil(seperators){\n\t\tif(this.data.length==0)\n\t\t\treturn \"\";\n\t\tvar i=-1, len=this.data.length;\n\t\t//find any one of seperator chars\n\t\twhile((++i)<len && seperators.indexOf(this.data.charAt(i))==-1);\n\n\t\tvar node=this.data.substring(0, i).trim();\n\n\t\t//ignore all seperator chars\n\t\tif(i<len)\n\t\t\twhile(++i<len && seperators.indexOf(this.data.charAt(i))!=-1);\n\n\t\t//left this.data\n\t\tthis.data=this.data.substring(i).trim();\n\t\treturn node;\n\t}\n\tnextNode(){\n\t\treturn this.nextUntil(\" \\\\\")\n\t}\n\tasInt(s, defaultValue){\n\t\ttry{\n\t\t\treturn parseInt(s)\n\t\t}catch(error){\n\t\t\treturn defaultValue||0\n\t\t}\n\t}\n}\nclass Switch extends Command{\n\tconstructor(cmd){\n\t\tsuper(...arguments)\n\t\tthis.withQuote=false\n\t\tthis.type=cmd.charAt(0).toLowerCase\n\t\tif(cmd.length>1 && this.type!='*' && cmd.charAt(1)!=' '){\n\t\t\tif(type.match(/\\w/)){//word case: \\s1=\\s 1\n\t\t\t\t try {\n\t\t\t\t\tparseInt(cmd.substring(1).trim());\n\t\t\t\t\tthis.data=cmd.substring(1).trim();\n\t\t\t\t\treturn;\n\t\t\t\t} catch (e) {\n\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.type='!';\n\t\t}else{\n\t\t\tif(this.data.length>1)\n\t\t\t\tthis.data=this.data.substring(1).trim();\n\t\t\telse\n\t\t\t\tthis.data=\"\";\n\t\t}\n\t\tthis.__removeQuote();\n\t}\n\t__removeQuote(){\n\t\tif(this.data.length==0)\n\t\t\treturn;\n\t\tvar a=this.data.charAt(0);\n\t\tif(a=='\"' || a=='\\''){\n\t\t\tthis.data=this.data.substring(1);\n\t\t\tthis.withQuote=true;\n\t\t}\n\t\tif(this.data.length==0)\n\t\t\treturn;\n\t\ta=this.data.charAt(this.data.length-1);\n\t\tif(a=='\"' || a=='\\''){\n\t\t\tthis.data=this.data.substring(0,this.data.length-1);\n\t\t\tthis.withQuote=true;\n\t\t}\n\t}\n\t_split2Int(){\n\t\tif(this.data==null || this.data.length==0)\n\t\t\treturn null;\n\t\tvar a=data.split(\"-\");\n\t\tif(a.length==0)\n\t\t\treturn null;\n\t\tvar b=[]\n\t\tfor(var i=0, len=a.length; i<len; i++){\n\t\t\ttry {\n\t\t\t\tb[i]=parseInt(a[i]);\n\t\t\t} catch (e) {\n\t\t\t\tb[i]=0;\n\t\t\t}\n\t\t}\n\t\treturn b;\n\t}\n}\nclass FieldCode extends Command{\n\tconstructor(instruct){\n\t\tsuper(...arguments)\n\t\tthis.mergeFormat=this.parseKeyWord(\"MERGEFORMAT\")\n\t\tthis.type=this.nextNode()\n\t}\n\tparseKeyWord(key){\n\t\tif(this.data.length==0)\n\t\t\treturn false;\n\t\tvar len=this.data.length;\n\t\tthis.data=this.data.replace(new RegExp(\"\\\\*\\\\s*\"+key+\"\\\\s*\", \"ig\"),\"\");\n\t\treturn this.data.length!=len;\n\t}\n\tnextSwitch(){\n\t\tvar option=this.nextUntil(\"\\\\\");\n\t\tif(option==null || option.length==0)\n\t\t\treturn null;\n\n\t\treturn new Switch(option);\n\t}\n\tparse(){}\n}\n"]}