{"version":3,"sources":["../../../../src/openxml/docx/model/style.js"],"names":[],"mappings":"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","file":"style.js","sourcesContent":["var RGB=/([a-fA-F0-9]{2}?){3}?/;\nexport default class Style extends require('../model'){\n\tconstructor(wXml,wDoc,mParent){\n\t\tsuper(...arguments)\n\t\tif(wXml.attr('w:default')=='1')\n\t\t\twDoc.style.setDefault(this)\n\t\tthis.name=this._val('name')\n\t\tif(this.id=this._attr('w:styleId'))\n\t\t\twDoc.style.set(this)\n\t}\n\tgetParentStyle(){\n\t\treturn this.wDoc.style.get(this._val('basedOn'))\n\t}\n\tisDefault(){\n\t\treturn this.wXml.attr('w:default')=='1'\n\t}\n\tgetNumId(){\n\t\treturn -1\n\t}\n\tgetOutlineLevel(){\n\t\treturn -1\n\t}\n\n\tstatic get Properties(){return Properties}\n}\n\nvar naming={}\nclass Properties extends require('../model'){\n\tstatic get type(){return null}\n\tstatic get naming(){return naming}\n\n\tget EMPTY(){return -999}\n\t//use parent visitor to visitor style nodes and attributes\n\tparse(visitors){\n\t\tvar values={}, naming=this.constructor.naming, type=this.constructor.type\n\t\tvisitors.forEach((visitor)=>{\n\t\t\t[this._getValidChildren(),this.wXml.attributes].forEach((children)=>{\n\t\t\t\tfor(var len=children.length,i=0;i<len;i++){\n\t\t\t\t\tvar node=children[i], name=node.localName\n\t\t\t\t\tif(values[name]==undefined && typeof(this[name])=='function')\n\t\t\t\t\t\tvalues[name]=this[name](node);\n\t\t\t\t\tvalues[name]!=this.EMPTY && visitor.visit(values[name],naming[name]||name,type)\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\t_getValidChildren(){\n\t\treturn this.wXml.childNodes\n\t}\n\tbasedOn(x){\n\t\treturn x.attr('w:val')\n\t}\n\tasColor(v){\n\t\tif(!v || v.length==0 || v=='auto')\n\t\t\treturn '#000000'\n\t\tv=v.split(' ')[0]\n\t\treturn v.charAt(0)=='#' ? v : (RGB.test(v) ? '#'+v : v)\n\t}\n\tshadeColor(color, percent) {\n\t\tif(!RGB.test(color))\n\t\t\treturn color\n\t\tvar R = parseInt(color.substring(1,3),16);\n\t\tvar G = parseInt(color.substring(3,5),16);\n\t\tvar B = parseInt(color.substring(5,7),16);\n\n\t\tR = parseInt(R * (100 + percent) / 100);\n\t\tG = parseInt(G * (100 + percent) / 100);\n\t\tB = parseInt(B * (100 + percent) / 100);\n\n\t\tR = (R<255)?R:255;\n\t\tG = (G<255)?G:255;\n\t\tB = (B<255)?B:255;\n\n\t\tvar RR = ((R.toString(16).length==1)?\"0\"+R.toString(16):R.toString(16));\n\t\tvar GG = ((G.toString(16).length==1)?\"0\"+G.toString(16):G.toString(16));\n\t\tvar BB = ((B.toString(16).length==1)?\"0\"+B.toString(16):B.toString(16));\n\n\t\treturn \"#\"+RR+GG+BB;\n\t}\n\tasObject(x, f){\n\t\tvar o={}\n\t\tfor(var i=0,attrs=x.attributes,len=attrs.length;i<len;i++)\n\t\t\to[attrs[i].localName]= f ? f(attrs[i].value) : attrs[i].value\n\t\treturn o\n\t}\n\tasPt(x, type){\n\t\tswitch(type){\n\t\tcase 'cm':\n\t\t\treturn parseInt(x)*28.3464567/360000;\n\t\tdefault://dxa\n\t\t\treturn parseInt(x)/20.0\n\t\t}\n\t}\n\tpt2Px(x){\n\t\tif(typeof(x)=='string')\n\t\t\tx=parseFloat(x.replace('pt',''))\n\t\treturn Math.floor(x*96/72)\n\t}\n}\n"]}