{"version":3,"sources":["../../../../src/openxml/docx/model/drawing.js"],"names":[],"mappings":"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","file":"drawing.js","sourcesContent":["\r\nimport Style from './style'\r\rexport default class drawing extends require('../model'){\r\tconstructor(wXml){\r\t\tsuper(...arguments)\r\t\tthis.wDrawing=null\r\t}\r\tgetDirectStyle(){\r\t\treturn new this.constructor.Properties(this.wDrawing,this.wDoc, this)\r\t}\r\t_getValidChildren(){\r\t\treturn []\r\t}\r\tstatic get Properties(){return Properties}\r\r\tstatic get SpProperties(){return SpProperties}\r}\r\rclass Properties extends Style.Properties{\r\t_getValidChildren(t){\r\t\treturn [this.wXml.$1('extent'), this.wXml.$1('effectExtent')]\r\t}\r\textent(x){//inline and anchor\r\t\treturn {width:this.asPt(x.attr('cx'),'cm'),height:this.asPt(x.attr('cy'),'cm')}\r\t}\r\teffectExtent(x){\r\t\treturn this.asObject(x,function(x){return this.asPt(x,'cm')}.bind(this))\r\t}\r\tdistT(x){\r\t\tif(x=parseInt(x.value))\r\t\t\treturn this.asPt(x,'cm')\r\t\treturn this.EMPTY\r\t}\r\tdistB(x){\r\t\treturn this.distT(x)\r\t}\r\tdistR(x){\r\t\treturn this.distT(x)\r\t}\r\tdistL(x){\r\t\treturn this.distT(x)\r\t}\r}\r\rvar naming={\r\t\tcustGeom:'path',\r\t\tprstGeom:'path'\r\t}\rclass SpProperties extends Style.Properties{\r\tstatic get naming(){return naming}\r\r\txfrm(x){\r\t\tvar ext=x.$1('ext'), offset=x.$1('off')\r\t\treturn this.world={\r\t\t\twidth:this.asPt(ext.attr('cx'),'cm'),\r\t\t\theight:this.asPt(ext.attr('cy'),'cm'),\r\t\t\tx:this.asPt(offset.attr('x'),'cm'),\r\t\t\ty:this.asPt(offset.attr('y'),'cm'),\r\t\t\trotation: parseInt(x.attr('rot')||0)/60000\r\t\t}\r\t}\r\tsolidFill(x){\r\t\tvar elColor=x.firstChild,\r\t\t\tcolor=this.asColor(elColor.attr('val')), t;\r\r\t\tif(color=='phClr')\r\t\t\treturn 'phClr'\r\r\t\tswitch(elColor.localName){\r\t\tcase 'schemeClr':\r\t\t\tcolor=this.wDoc.getColorTheme().get(color)\r\t\t\tbreak\r\t\t}\r\r\t\tif(t=elColor.$1('shade'))\r\t\t\tcolor=this.shadeColor(color,-1*parseInt(t.attr('val'))/1000)\r\r\t\tif(t=elColor.$1('lumOff'))\r\t\t\tcolor=this.shadeColor(color,-1*parseInt(t.attr('val'))/1000)\r\r\t\treturn color\r\t}\r\tnoFill(x){\r\t\treturn 1\r\t}\r\tgradFill(x){\r\t\tvar type=x.$1('lin,path'), o=this.asObject(type), stops=[]\r\t\tfor(var gs=x.$('gs'),a,i=0,len=gs.length;i<len;i++)\r\t\t\tstops.push({position:parseInt(gs[i].attr('pos'))/1000, color:this.solidFill(gs[i])})\r\t\to.ang && (o.angel=parseInt(o.ang)/60000, delete o.ang);\r\t\to.path && (o.rect=this.asObject(type.firstChild, (x)=>parseInt(x)/1000));\r\t\to.path=type.localName=='lin' ? 'linear' : o.path;\r\t\to.stops=stops\r\t\treturn o\r\t}\r\tln(x){\r\t\tif(x.$1('noFill'))\r\t\t\treturn {width:0}\r\r\t\tvar o=this.asObject(x), t;\r\r\t\t(t=x.$1('solidFill')) && (o.color=this.solidFill(t));\r\r\t\t(t=o.w) && (o.width=this.asPt(t,'cm')) && (delete o.w);\r\t\t(t=x.$1('prstDash')) && (o.dash=t.attr('val'));\r\t\treturn o\r\t}\r\teffectLst(x){\r\r\t}\r\tblipFill(x){\r\t\treturn this.wDoc.getRel(x.$1('blip').attr('r:embed'))\r\t}\r\tprstGeom(x){\r\t\tvar px=this.pt2Px, w=px(this.world.width), h=px(this.world.height);\r\t\tswitch(x.attr('prst')){\r\t\tcase 'leftBrace':\r\t\t\treturn {shape:'path', path:'M '+w+' 0 L 0 '+h/2+' L '+w+' '+h+' Z'}\r\t\tdefault:\r\t\t\treturn {shape:x.attr('prst')}\r\t\t}\r\t}\r\tcustGeom(x){\r\t\tvar path=[], px=function(x){return this.pt2Px(this.asPt(x,'cm'))}.bind(this);\r\t\tfor(var a, children=x.$1('path').childNodes, len=children.length,i=0;i<len;i++){\r\t\t\ta=children[i]\r\t\t\tswitch(a.localName){\r\t\t\tcase 'moveTo':\r\t\t\t\tpath.push('M '+px(a.firstChild.attr('x'))+' '+px(a.firstChild.attr('y')))\r\t\t\t\tbreak\r\t\t\tcase 'lnTo':\r\t\t\t\tpath.push('L '+px(a.firstChild.attr('x'))+' '+px(a.firstChild.attr('y')))\r\t\t\t\tbreak\r\t\t\tbreak\r\t\t\tcase 'cubicBezTo':\r\t\t\t\tpath.push('L '+px(a.childNodes[0].attr('x'))+' '+px(a.childNodes[0].attr('y')))\r\t\t\t\tpath.push('Q '+px(a.childNodes[1].attr('x'))+' '+px(a.childNodes[1].attr('y'))\r\t\t\t\t\t+' '+px(a.childNodes[2].attr('x'))+' '+px(a.childNodes[2].attr('y')))\r\t\t\tbreak\r\t\t\t}\r\t\t}\r\t\treturn {shape:'path', path:path.join(' ')}\r\t}\r}\r"]}