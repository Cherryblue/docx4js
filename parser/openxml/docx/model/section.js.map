{"version":3,"sources":["../../../../src/openxml/docx/model/section.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;qBACkB,UAAU;;;;sBACT,UAAU;;;;sBACV,UAAU;;;;4BACX,iBAAiB;;;;IAEd,OAAO;WAAP,OAAO;;AAChB,UADS,OAAO,CACf,IAAI,EAAE,IAAI,EAAE,OAAO,EAAC;wBADZ,OAAO;;AAE1B,6BAFmB,OAAO,8CAEjB,SAAS,EAAC;AACnB,SAAO,CAAC,OAAO,CAAC,GAAG,EAAE,CAAA;AACrB,MAAI,CAAC,MAAM,GAAC,OAAO,CAAC,OAAO,CAAC,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,GAAC,CAAC,CAAC,CAAC,KAAK,CAAC,WAAW,GAAG,OAAO,CAAC,IAAI,CAAC,UAAU,CAAA;;AAE1H,MAAI,CAAC,KAAK,GAAC,IAAI,CAAA;AACf,SAAM,IAAI,CAAC,KAAK,CAAC,UAAU,IAAE,OAAO,CAAC,IAAI,EACxC,IAAI,CAAC,KAAK,GAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAA;AACjC,MAAG,IAAI,CAAC,KAAK,IAAE,IAAI,EAClB,IAAI,CAAC,KAAK,GAAC,IAAI,CAAC,eAAe,CAAA;;AAEhC,SAAO,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;;AAE1B,MAAI,CAAC,YAAY,CAAC,OAAO,CAAC,OAAO,GAAC,IAAI,CAAA;EACtC;;cAfmB,OAAO;;SAiBnB,kBAAC,CAAC,EAAE,gBAAgB,EAAC;AAC5B,OAAI,CAAC,oBAAoB,CAAC,gBAAgB,EAAC,QAAQ,CAAC,CAAA;AACpD,OAAI,OAAO,GAAC,IAAI,CAAC,MAAM,CAAA;AACvB,MAAE;AACD,KAAC,CAAC,OAAO,CAAC,CAAA;AACV,WAAO,GAAC,OAAO,IAAE,IAAI,CAAC,KAAK,GAAG,IAAI,GAAG,OAAO,CAAC,WAAW,CAAA;IACxD,QAAM,OAAO,EAAC;AACf,OAAI,CAAC,oBAAoB,CAAC,gBAAgB,EAAC,QAAQ,CAAC,CAAA;GACpD;;;SAEmB,8BAAC,gBAAgB,EAAC,OAAO,EAAC;AAC7C,QAAI,IAAI,IAAI,GAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,GAAC,WAAW,CAAC,EAAC,CAAC,GAAC,CAAC,EAAC,GAAG,GAAC,IAAI,CAAC,MAAM,EAAC,CAAC,GAAC,GAAG,EAAC,CAAC,EAAE,EAAC;AAC3E,QAAI,IAAI,GAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,GAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAA;AACnF,QAAI,KAAK,GAAC,KAAK,OAAO,CAAC,IAAI,GAAC,OAAO,EAAC,CAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAA;AACpG,SAAK,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAA;AAC7B,QAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,GAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAA;IACtD;GACD;;;SACa,0BAAE;AACf,UAAO,8BAAU,IAAI,CAAC,IAAI,EAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;GAC3C;;;OAEc,eAAE;AAAC,UAAO,SAAS,CAAA;GAAC;;;QAvCf,OAAO;;;qBAAP,OAAO","file":"section.js","sourcesContent":["\nimport Model from '../model'\nimport Header from './header'\nimport Footer from './footer'\nimport Style from './style/section'\n\nexport default class section extends Model{\n\tconstructor(wXml, wDoc, mParent){\n\t\tsuper(...arguments)\n\t\tmParent.content.pop()\n\t\tthis.wFirst=mParent.content.length ? mParent.content[mParent.content.length-1].wLast.nextSibling : mParent.wXml.firstChild\n\n\t\tthis.wLast=wXml\n\t\twhile(this.wLast.parentNode!=mParent.wXml)\n\t\t\tthis.wLast=this.wLast.parentNode\n\t\tif(this.wLast==wXml)\n\t\t\tthis.wLast=wXml.previousSibling\n\n\t\tmParent.content.push(this)\n\n\t\twDoc.parseContext.section.current=this\n\t}\n\n\t_iterate(f, visitorFactories){\n\t\tthis._iterateHeaderFooter(visitorFactories,'header')\n\t\tvar current=this.wFirst\n\t\tdo{\n\t\t\tf(current)\n\t\t\tcurrent=current==this.wLast ? null : current.nextSibling\n\t\t}while(current)\n\t\tthis._iterateHeaderFooter(visitorFactories,'footer')\n\t}\n\n\t_iterateHeaderFooter(visitorFactories,refType){\n\t\tfor(var refs=this.wXml.$(refType+'Reference'),i=0,len=refs.length;i<len;i++){\n\t\t\tvar part=this.wDoc.parseContext.part.current=this.wDoc.getRel(refs[i].attr('r:id'))\n\t\t\tvar model=new (require('./'+refType))(part.documentElement, this.wDoc, this, refs[i].attr('w:type'))\n\t\t\tmodel.parse(visitorFactories)\n\t\t\tthis.wDoc.parseContext.part.current=this.wDoc.partMain\n\t\t}\n\t}\n\tgetDirectStyle(){\n\t\treturn new Style(this.wXml,this.wDoc, this)\n\t}\n\n\tstatic get type(){return 'section'}\n}\n"]}