{"version":3,"sources":["../../../src/openxml/docx/document.js"],"names":[],"mappings":"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","file":"document.js","sourcesContent":["import factory from './factory'\nimport FontTheme from './theme/font'\nimport ColorTheme from './theme/color'\nimport FormatTheme from './theme/format'\n\nexport default class document extends require('../document'){\n\tconstructor(){\n\t\tsuper(...arguments)\n\t\tvar rels=this.rels,\n\t\t\tbuiltIn='settings,webSettings,theme,styles,stylesWithEffects,fontTable,numbering,footnotes,endnotes'.split(',')\n\t\t$.each(this.partMain.rels,function(id,rel){\n\t\t\tbuiltIn.indexOf(rel.type)!=-1 && (rels[rel.type]=rel.target)\n\t\t})\n\t\tthis.style=new this.constructor.Style()\n\t\tthis.parseContext={\n\t\t\tsection: new ParseContext(),\n\t\t\tpart:new ParseContext(this.partMain),\n\t\t\tbookmark: new ParseContext(),\n\t\t\tfield: (function(ctx){\n\t\t\t\tctx.instruct=function(t){\n\t\t\t\t\tthis[this.length-1].instruct(t)\n\t\t\t\t}\n\t\t\t\tctx.seperate=function(model){\n\t\t\t\t\tthis[this.length-1].seperate(model)\n\t\t\t\t}\n\t\t\t\tctx.end=function(model){\n\t\t\t\t\tthis.pop().end(model)\n\t\t\t\t}\n\t\t\t\treturn ctx\n\t\t\t})([])\n\t\t};\n\t}\n\tstatic get ext(){return 'docx'}\n\n\tparse(visitFactories){\n\t\tsuper.parse(...arguments)\n\t\tthis.content=this.factory(this.partMain.documentElement, this)\n\t\tvar roots=this.content.parse($.isArray(visitFactories) ? visitFactories : $.toArray(arguments))\n\t\tthis.release()\n\t\treturn roots.length==1 ? roots[0] : roots\n\t}\n\tgetRel(id){\n\t\treturn this.parseContext.part.current.getRel(id)\n\t}\n\tgetColorTheme(){\n\t\tif(this.colorTheme)\n\t\t\treturn this.colorTheme\n\t\treturn this.colorTheme=new ColorTheme(this.getPart('theme').documentElement.$1('clrScheme'), this.getPart('settings').documentElement.$1('clrSchemeMapping'))\n\t}\n\tgetFontTheme(){\n\t\tif(this.fontTheme)\n\t\t\treturn this.fontTheme\n\t\treturn this.fontTheme=new FontTheme(this.getPart('theme').documentElement.$1('fontScheme'), this.getPart('settings').documentElement.$1('themeFontLang'))\n\t}\n\tgetFormatTheme(){\n\t\tif(this.formatTheme)\n\t\t\treturn this.formatTheme\n\t\treturn this.formatTheme=new FormatTheme(this.getPart('theme').documentElement.$1('fmtScheme'), this)\n\t}\n\trelease(){\n\t\tdelete this.parseContext\n\t\tsuper.release(...arguments)\n\t}\n\n\tstatic get type(){return \"Word\"}\n\n\tstatic get Style(){return Style}\n\n\tstatic get factory(){return factory}\n}\n\nfunction Style(){\n\tvar ids={},defaults={}\n\tObject.assign(this,{\n\t\tsetDefault: function(style){\n\t\t\tdefaults[style.type]=style\n\t\t},\n\t\tgetDefault: function(type){\n\t\t\treturn defaults[type]\n\t\t},\n\t\tget: function(id){\n\t\t\treturn ids[id]\n\t\t},\n\t\tset: function(style, id){\n\t\t\tids[id||style.id]=style\n\t\t}\n\t})\n}\n\nclass ParseContext{\n\tconstructor(current){\n\t\tthis.current=current\n\t}\n}\n"]}