{"version":3,"sources":["../../src/openxml/document.js"],"names":[],"mappings":"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","file":"document.js","sourcesContent":["import Part from './part'\n\nexport default class Document extends require('../document'){\n\tconstructor(){\n\t\tsuper(...arguments)\n\t\tvar rels=this.rels={}\n\t\t$.each(new Part(\"\",this).rels,function(id,rel){\n\t\t\trels[rel.type]=rel.target\n\t\t})\n\t\tthis.partMain=new Part(this.rels['officeDocument'],this)\n\t\tthis.content=[]\n\t}\n\tget vender(){\"Microsoft\"}\n\n\tget product(){return 'Office 2010'}\n\n\tgetPart(name){\n\t\tvar part=this.parts[name] || ((name=this.rels[name])&&this.parts[name])\n\t\tif(!part)\n\t\t\treturn null\n\n\t\tif(Part.is(part))\n\t\t\treturn part\n\n\t\treturn this.parts[name]=new Part(name,this)\n\t}\n\tparse(){\n\t\tsuper.parse(...arguments)\n\t\tthis.getPart('core-properties').documentElement\n\t\t.$('keywords,description,title').forEach(function(x){\n\t\t\tvar v=x.textContent.trim();\n\t\t\tv.length && (this[x.localName]=v)\n\t\t},this.props)\n\t\ttypeof this.props.keywords!='undefined' && (this.props.keywords=this.props.keywords.split(','));\n\n\t\tthis.getPart('extended-properties').documentElement\n\t\t.$('Template').forEach(function(x){\n\t\t\tvar v=x.textContent.trim();\n\t\t\tv.length && (this[x.localName]=v)\n\t\t},this.props)\n\t}\n\n\tstatic get Visitor(){ return Visitor}\n\n\t/**\n\t *  To create a factory function that to create a visitor specific to word model types\n\t *  factory: it could be following type\n\t *  \t* function(wordModel, targetParent) :\n\t *  \t\t\twordModel: identified word model\n\t *  \t\t\ttargetParent: the result created by visitor of srcModel's parent model\n\t *  \t* object: {'word model type name': Visitor Class}\n\t *  \t* undefined: a default factory just to info type of word model in console\n\t *  opt: a global option to all visitor instances created by the factory, refered by visitor.options\n\t */\n\tstatic createVisitorFactory(factory, opt){\n\t\tvar Any=this.Visitor\n\t\tswitch(typeof factory){\n\t\tcase 'function':\n\t\t\tbreak\n\t\tcase 'object':\n\t\t\tvar rawMap=factory;\n\t\t\tfactory=function(srcModel, targetParent){\n\t\t\t\tvar map=factory.map\n\t\t\t\tif(map['*'])\n\t\t\t\t\tAny=map['*'];\n\t\t\t\tvar Visitor=map[srcModel.type], visitor, t;\n\t\t\t\tif(!srcModel.type)\n\t\t\t\t\t;\n\t\t\t\telse if(Visitor)\n\t\t\t\t\tvisitor=new Visitor(srcModel, targetParent)\n\t\t\t\telse if((t=srcModel.type.split('.')).length>1){\n\t\t\t\t\tdo{\n\t\t\t\t\t\tt.pop()\n\t\t\t\t\t\tif((Visitor=map[t.join('.')])){\n\t\t\t\t\t\t\tvisitor=new Visitor(srcModel, targetParent)\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t}while(t.length>1)\n\t\t\t\t}\n\n\t\t\t\tif(!visitor)\n\t\t\t\t\tvisitor=new Any(srcModel, targetParent);\n\n\t\t\t\tif(!visitor._shouldIgnore())\n\t\t\t\t\treturn visitor\n\t\t\t}\n\n\t\t\tfactory.map=rawMap\n\t\t\tbreak\n\t\tcase 'undefined':\n\t\t\tfactory=function(srcModel, targetParent){\n\t\t\t\treturn new Any(srcModel, targetParent)\n\t\t\t}\n\t\t\tbreak\n\t\tdefault:\n\t\t\tthrow 'unsupported factory'\n\t\t}\n\n\t\tif(opt){\n\t\t\tvar _raw=factory\n\t\t\tfactory=function(){\n\t\t\t\tvar converter=_raw.apply(null,arguments)\n\t\t\t\t\tconverter && (converter.options=opt);\n\t\t\t\treturn converter\n\t\t\t}\n\t\t\tif(typeof(_raw.map)!='undefined')\n\t\t\t\tfactory.map=_raw.map\n\t\t}\n\n\t\tfactory.with=function(targetParent){\n\t\t\tfunction paramizedFactory(srcModel){\n\t\t\t\treturn factory(srcModel, targetParent)\n\t\t\t}\n\t\t\tparamizedFactory.with=factory.with\n\t\t\treturn paramizedFactory\n\t\t}\n\n\t\treturn factory\n\t}\n}\n\n/**\n *  A visitor to visit a type of word model\n *  srcModel: identified word model\n *  targetParent: the result created by visitor of srcModel's parent model\n */\nclass Visitor{\n\tconstructor(srcModel, targetParent){\n\t\tthis.srcModel=srcModel\n\t\tthis.parent=parent\n\t}\n\tvisit(){\n\t\tconsole.info(this.srcModel.type)\n\t}\n\t_shouldIgnore(){\n\t\treturn false\n\t}\n}\n"]}