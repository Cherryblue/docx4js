"use strict";

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.parse = parse;

var _cfb = require("cfb");

var _cfb2 = _interopRequireDefault(_cfb);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function parse(data) {
	var ole = _cfb2.default.parse(data);
	var content = ole.find("!ole10Native").content;
	var start = content.slice(0, Math.min(content.length / 2, 512)).lastIndexOf(0) + 1;
	var end = content.indexOf(0, Math.min(start, content.length / 2)) - 1;
	return new TextDecoder("utf-8").decode(new Uint8Array(content.slice(start, end)));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9vcGVueG1sL29sZS5qcyJdLCJuYW1lcyI6WyJwYXJzZSIsImRhdGEiLCJvbGUiLCJjb250ZW50IiwiZmluZCIsInN0YXJ0Iiwic2xpY2UiLCJNYXRoIiwibWluIiwibGVuZ3RoIiwibGFzdEluZGV4T2YiLCJlbmQiLCJpbmRleE9mIiwiVGV4dERlY29kZXIiLCJkZWNvZGUiLCJVaW50OEFycmF5Il0sIm1hcHBpbmdzIjoiOzs7OztRQUVnQkEsSyxHQUFBQSxLOztBQUZoQjs7Ozs7O0FBRU8sU0FBU0EsS0FBVCxDQUFlQyxJQUFmLEVBQW9CO0FBQzFCLEtBQUlDLE1BQUksY0FBSUYsS0FBSixDQUFVQyxJQUFWLENBQVI7QUFDQSxLQUFJRSxVQUFRRCxJQUFJRSxJQUFKLENBQVMsY0FBVCxFQUF5QkQsT0FBckM7QUFDQSxLQUFJRSxRQUFNRixRQUFRRyxLQUFSLENBQWMsQ0FBZCxFQUFnQkMsS0FBS0MsR0FBTCxDQUFTTCxRQUFRTSxNQUFSLEdBQWUsQ0FBeEIsRUFBMEIsR0FBMUIsQ0FBaEIsRUFBZ0RDLFdBQWhELENBQTRELENBQTVELElBQStELENBQXpFO0FBQ0EsS0FBSUMsTUFBSVIsUUFBUVMsT0FBUixDQUFnQixDQUFoQixFQUFrQkwsS0FBS0MsR0FBTCxDQUFTSCxLQUFULEVBQWVGLFFBQVFNLE1BQVIsR0FBZSxDQUE5QixDQUFsQixJQUFvRCxDQUE1RDtBQUNBLFFBQU8sSUFBSUksV0FBSixDQUFnQixPQUFoQixFQUF5QkMsTUFBekIsQ0FBZ0MsSUFBSUMsVUFBSixDQUFlWixRQUFRRyxLQUFSLENBQWNELEtBQWQsRUFBb0JNLEdBQXBCLENBQWYsQ0FBaEMsQ0FBUDtBQUNBIiwiZmlsZSI6Im9sZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPTEUgZnJvbSBcImNmYlwiXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2UoZGF0YSl7XHJcblx0bGV0IG9sZT1PTEUucGFyc2UoZGF0YSlcclxuXHRsZXQgY29udGVudD1vbGUuZmluZChcIiFvbGUxME5hdGl2ZVwiKS5jb250ZW50XHJcblx0bGV0IHN0YXJ0PWNvbnRlbnQuc2xpY2UoMCxNYXRoLm1pbihjb250ZW50Lmxlbmd0aC8yLDUxMikpLmxhc3RJbmRleE9mKDApKzFcclxuXHRsZXQgZW5kPWNvbnRlbnQuaW5kZXhPZigwLE1hdGgubWluKHN0YXJ0LGNvbnRlbnQubGVuZ3RoLzIpKS0xXHJcblx0cmV0dXJuIG5ldyBUZXh0RGVjb2RlcihcInV0Zi04XCIpLmRlY29kZShuZXcgVWludDhBcnJheShjb250ZW50LnNsaWNlKHN0YXJ0LGVuZCkpKVxyXG59Il19