<!DOCTYPE html>
<html>
<head>
	<script src="../node_modules/requirejs/require.js"></script>
	<script>
		require.config({
			baseUrl: "../",
			paths: {
				"jszip": "test/jszip.min",
				"tool": "parser/tool-browser",
				"deferred": "node_modules/Deferred/index"
			},
			deps:['tool']
		});
	</script>
	<script>
		var converter=[]
		converter.visit=function(){
			if(this.model.type=='paragraph')
				return this.push("\n\r")
			if(this.model.type=='text')
				return this.push(this.model.getText())
		}
		
		function test(input){
			require(['parser/openxml/docx/document'],function(DOCX){
				converter.splice(0,converter.length)
				DOCX.load(input.files[0])
					.then(function(doc){
						input.value=""
						document.$1('body>pre').innerHTML=""
						doc.parse(DOCX.createVisitorFactory(), DOCX.createVisitorFactory(function(srcModel){
							converter.model=srcModel
							return converter;
						}))
						document.$1('body>pre').innerHTML=converter.join('')
					})
			})
		}
	</script>
</head>
<body>
	<input type="file" style="position:absolute;top:0" onchange="test(this)">
	<pre></pre>
</body>
</html>